server {
    # Fix for conflicts and domain access
    listen 80 default_server;
    server_name helios.study www.helios.study;

    # 1. Route API traffic to the backend service
    location /api/ {
        # Ensure you include the path /api/ in proxy_pass if your backend expects it
        proxy_pass http://backend:5000; 
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /snowflake/ {
    proxy_pass http://backend:5000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    
    }

    # 2. Serve static front-end files
    location / {
        # ðŸš¨ CORRECT FIX: Pass the request to the dedicated frontend container ðŸš¨
        # The 'frontend:80' is the Docker service name and internal port
        proxy_pass http://frontend:80; 
        
        # Keep necessary headers
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        
        # NOTE: The try_files logic is handled inside the frontend container's Nginx config.
    }
}
